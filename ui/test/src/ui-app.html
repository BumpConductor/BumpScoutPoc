<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">
    <script src="../../../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
    <script src="../../../bower_components/web-component-tester/browser.js"></script>

    <link rel="import" href="../helpers/common.html">
    <link rel="import" href="../../src/ui-app.html">
  </head>
  <body>
    <test-fixture id="fixture-default">
      <template>
        <ui-app></ui-app>
      </template>
    </test-fixture>
    <script>
    var uiApp;
    describe('uiApp ', function() {
      describe('Event Listeners', function() {
        beforeEach(function(done) {
          app.helpers.reset();
          uiApp = fixture('fixture-default');
          flush(done);
        });
        it('should listen for a request-menu event', function(done) {
            uiApp.addEventListener('request-menu', function(event) {
              done();
            });
            uiApp.fire('request-menu');
        });
        it('should listen for a request-signin event', function(done) {
            uiApp.addEventListener('request-signin', function(event) {
              done();
            });
            uiApp.fire('request-signin');
        });
        it('should listen for a request-signout event', function(done) {
            uiApp.addEventListener('request-signout', function(event) {
               done();
            });
            uiApp.fire('request-signout');
        });
        it('should listen for a signout-confirmed event', function(done) {
            uiApp.addEventListener('signout-confirmed', function(event) {
              done();
            });
            uiApp.fire('signout-confirmed');
        });
        it('should listen for a signout-cancelled event', function(done) {
            uiApp.addEventListener('signout-cancelled', function(event) {
              done();
            });
            uiApp.fire('signout-cancelled');
        }); 
        it('should listen for a request-view-solvers event', function(done) {
            uiApp.addEventListener('request-view-solvers', function(event) {
              done();
            });
            uiApp.fire('request-view-solvers');
        }); 
        it('should listen for a request-view-bumps event', function(done) {
            uiApp.addEventListener('request-view-bumps', function(event) {
              done();
            });
            uiApp.fire('request-view-bumps');
        }); 
      }); //End of Event listeners     
      describe('Action Dispatchers', function() {
        beforeEach(function(done) {
          app.helpers.reset();
          uiApp = fixture('fixture-default');
          flush(done);
        });
        it('should dispatch a signOut action when request-signout received', function() {
          uiApp.fire('signout-confirmed');
          app.auth.signOut.should.have.been.calledOnce;
              store.dispatch.should.have.been.calledWith(
                app.auth.signOut.value);
        });
      }); //End of Acion Dispatchers  
      describe('when SignedOut', function() {
          beforeEach(function(done) {
            app.helpers.reset();
            app.auth.isSignedOut.value = true;
            uiApp = fixture('fixture-default');
            flush(done);
          });
          it('should set element attributes to isSignedOut', function() {
            expect(uiApp.$.bumpAppHeader.isSignedOut).to.be.true;
          });
      });    
      describe('when SignedIn', function() {
          before(function(done) {
            app.helpers.reset();
            app.auth.isSignedIn.value = true;
            uiApp = fixture('fixture-default');
            flush(done);
          });
          it('should set element attributes to isSignedOut', function() {
            expect(uiApp.$.bumpAppHeader.isSignedIn).to.be.true;
          }); 
      });    
      describe('When Pending', function() {
         before(function(done) {
            app.helpers.reset();
            app.auth.isPending.value = true;
            uiApp = fixture('fixture-default');
            flush(done);
          });
          it('should set element attributes to isPending', function() {
             expect(uiApp.$.bumpAppHeader.isPending).to.be.true;
          });
      });
    });
    </script>
  </body>
</html>
